<?

/*
 * $Id$
 *
 * User class.
 */

class user_t {

    var $id;
    var $username;

    var $realname;
    var $address;
    var $zip;
    var $city;
    var $state;
    var $country;
    var $phone;
    var $email;
    var $url;

    var $hiddeninfo;

    var $image;
    var $profile;

    // Load $target's userfile into this class.
    //
    function init( $target ) {
        $result = mysql_query("SELECT id,username,name,address,zip,city,state,country,phone,email,url,hiddeninfo,content_type,profile FROM user WHERE username='$target'");
        $num = mysql_numrows($result);
        if ($num) {
            $this->id = mysql_result($result, $i, "id");
            $this->username = mysql_result($result, $i, "username");
            $this->hiddeninfo = mysql_result($result, $i, "hiddeninfo");
            $this->realname = mysql_result($result, $i, "name");
            $this->address = mysql_result($result, $i, "address");
            $this->zip = mysql_result($result, $i, "zip");
            $this->city = mysql_result($result, $i, "city");
            $this->state = mysql_result($result, $i, "state");
            $this->country = mysql_result($result, $i, "country");
            $this->phone = mysql_result($result, $i, "phone");
            $this->email = mysql_result($result, $i, "email");
            $this->url = mysql_result($result, $i, "url");
            $this->image = mysql_result($result, $i, "content_type");
            $this->profile = mysql_result($result, $i, "profile");
            return true;
        }
        return false;
    }

    // Get this user's name.
    //
    function getname() {
        return $this->username;
    }

    // Get this user's usernumber.
    //
    function getnum() {
        return $this->id;
    }

    // Show user's profile.
    //
    function show_profile() {
       addimage("$this->username's Profile");
       $this->add_info();
       $this->add_image();
       $this->add_profile();
    }

    // Add user's info. (if available)
    function add_info() {
        echo "<p align=\"left\">\n";
        if( ! (strstr( $this->hiddeninfo, "name" )))
            echo "Name: $this->realname";
        if( ! (strstr( $this->hiddeninfo, "address" )))
            echo "<br>\nAddress: $this->address";
        if( ! (strstr( $this->hiddeninfo, "city" )))
            echo "<br>\n$this->city";
        if( ! (strstr( $this->hiddeninfo, "state" )))
            echo ", $this->state";
        if( ! (strstr( $this->hiddeninfo, "zip" )))
            echo " $this->zip\n";
        if( ! (strstr( $this->hiddeninfo, "country" )))
            echo "<br>\n$this->country";
        if( ! (strstr( $this->hiddeninfo, "phone" )))
            echo "<br>\nPhone: $this->phone";
        if( ! (strstr( $this->hiddeninfo, "email" )))
            echo "<br>\nEmail: <a href=\"mailto:$this->email\">$this->email</a>";
        if( (!(strstr( $this->hiddeninfo, "url" ))) && (strlen($this->url)))
            echo "<br>\nURL: <a href=\"http://$this->url\">$this->url</a>";
        return;
    }

    // Add user's profile.
    //
    function add_profile() {
        $this->profile = htmlspecialchars($this->profile);
        $this->profile = colorize($this->profile);
        echo "<pre><font color=\"#00ffff\">$this->profile</font></pre>\n";
    }

    // Add user's profile pic if it exists.
    //
    function add_image() {
        if( valid_image($this->image)) {
            if( $this->image == "image/gif")
                echo "<img align=\"center\" src=\"/bbs/pix/gif.php3?$this->id\">\n";
            else if ($this->image == "image/jpg" || $image == "image/jpeg" || $image == "image/pjpeg")
                echo "<img align=\"center\" src=\"/bbs/pix/jpeg.php3?$this->id\">\n";
            else if ($this->image == "image/png")
                echo "<img align=\"center\" src=\"/bbs/pix/png.php3?$this->id\">\n";
            else {
                errorimage("Image is in unsupported format!");
                return -1;
            }
        }
        return 0;
    }
}

?>
